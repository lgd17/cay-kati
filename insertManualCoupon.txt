async function insertManualCoupon(content, mediaUrl, mediaType, date, type = "gratuit") {
  try {
    // --- Vérification de la date ---
    if (!date) throw new Error("Date manquante");

    // Convertir en objet Date valide (minuit UTC si date au format YYYY-MM-DD)
    let timestamp;
    if (date instanceof Date) {
      timestamp = date;
    } else {
      timestamp = new Date(date + "T00:00:00Z");
    }

    if (isNaN(timestamp.getTime())) {
      throw new Error("Date invalide : " + date);
    }

    // --- Insertion dans la DB ---
    await pool.query(`
      INSERT INTO daily_pronos (content, media_url, media_type, date, type)
      VALUES ($1, $2, $3, $4, $5)
      ON CONFLICT (date_only) DO UPDATE
      SET content = EXCLUDED.content,
          media_url = EXCLUDED.media_url,
          media_type = EXCLUDED.media_type,
          type = EXCLUDED.type
    `, [content, mediaUrl, mediaType, timestamp, type]);

    return { success: true };
  } catch (err) {
    console.error("❌ Erreur lors de l'ajout manuel :", err);
    return { success: false, error: err };
  }
}
